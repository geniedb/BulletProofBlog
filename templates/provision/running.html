{% extends "base.html" %}
{% block headextra %}
<script type="text/javascript">
function handleJson(info) {
	$("#"+info.node_id+"link").css('background-color', info.status==0 ? "#CCFFCC" : "#FFCCCC");
	$("#"+(info.status==0 ? "stop_" : "start_") +info.node_id).show();
	$("#"+(info.status==0 ? "start_" : "stop_") +info.node_id).hide();
}

function requestUpdates() {
{% for node in nodes %}
	$.getJSON('{{node.type}}/',{format:'json'},handleJson);
	$.getJSON('{{node.type}}/',{format:'json'},handleJson);
{% endfor %}
}

$(document).ready(function() {
	window.setInterval(requestUpdates, 10000);
	requestUpdates();
{% for node in nodes %}
	$("#{{node.type}}link").css('background-color', "#CCFFCC");
	$("#start_{{node.type}}").hide();
{% endfor %}
});
</script>
{% endblock %}
{% block content %}
<h2>Your demo is running</h2>

<a id="bplink" href="http://{{demo.pk}}.bulletproofblog.geniedb.com/">Bullet Proof Blog</a>

<div class="stylized">
<h3>Your Nodes</h3>
<table><tr>
{% for node in nodes %}
<td><form method="post" action="{{node.type}}/">
{% csrf_token %}
Node {{node.type}}
<a id="{{node.type}}link" href="http://{{node.dns}}/">Link</a><br />
<button type="submit" id="start_{{node.type}}" name="action" value="start">Start</button>
<button type="submit" id="stop_{{node.type}}" name="action" value="stop">Stop</button>
</form></td>
{% endfor %}
</tr></table>
</div>

{% endblock %}